////////////////////////////////////////////////////////////////////////////////////////////////////
// file:	Support\DbQueryResult.cs
//
// summary:	Implements the database query result class
////////////////////////////////////////////////////////////////////////////////////////////////////

using System;

namespace LawsonOperationResult
{
	////////////////////////////////////////////////////////////////////////////////////////////////////
	/// <summary>	Encapsulates the result of a database query. </summary>
	///
	/// <typeparam name="T">	Generic type parameter. </typeparam>
	///
	/// <seealso cref="T:LawsonOperationResult.DBSupport.DbResult"/>
	////////////////////////////////////////////////////////////////////////////////////////////////////

	public class DbQueryResult<T> : DbResult
	{
		////////////////////////////////////////////////////////////////////////////////////////////////////
		/// <summary>	Gets or sets the query result. </summary>
		///
		/// <value>	The query result. </value>
		////////////////////////////////////////////////////////////////////////////////////////////////////

		public T[] QueryResult { get; set; }

		////////////////////////////////////////////////////////////////////////////////////////////////////
		/// <summary>	Constructor. </summary>
		///
		/// <param name="result">	The result. </param>
		////////////////////////////////////////////////////////////////////////////////////////////////////

		public DbQueryResult(T[] result)
			: base(result.Length)
		{
			QueryResult = result;
		}

		////////////////////////////////////////////////////////////////////////////////////////////////////
		/// <summary>	Constructor. </summary>
		///
		/// <param name="ex">	The ex. </param>
		////////////////////////////////////////////////////////////////////////////////////////////////////

		public DbQueryResult(Exception ex)
		: base(ex)
		{
			QueryResult = new T[0];
		}
	}
}
